<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meus Progressos - Formul√°rio para Pais</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, connectFirestoreEmulator } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAuth, signInAnonymously, connectAuthEmulator } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        
        // Configura√ß√£o do Firebase - Projeto Real
        const firebaseConfig = {
            apiKey: "AIzaSyD_fkKU3N61u3HxKklIbdAMK2qUAPDVHhQ",
            authDomain: "avaliacao-habilidades-2024.firebaseapp.com",
            projectId: "avaliacao-habilidades-2024",
            storageBucket: "avaliacao-habilidades-2024.firebasestorage.app",
            messagingSenderId: "1026943873619",
            appId: "1:1026943873619:web:50276ae57af2e3a9ea0ca6",
            measurementId: "G-3LNVBBET4E"
        };
        
        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // Configurar autentica√ß√£o an√¥nima e aguardar antes de usar Firestore
        async function initializeFirebaseAuth() {
            try {
                await signInAnonymously(auth);
                console.log('Autentica√ß√£o an√¥nima realizada com sucesso');
                window.firebase = { app, db, auth, initialized: true };
            } catch (error) {
                console.error('Erro na autentica√ß√£o:', error);
                window.firebase = { app, db, auth, initialized: false, error };
            }
        }
        
        // Inicializar autentica√ß√£o
        initializeFirebaseAuth();
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìà Meus Progressos</h1>
            <h2>Formul√°rio de Avalia√ß√£o para Pais e Respons√°veis</h2>
            <div class="progress-indicator">
                <div class="progress-bar">
                    <div class="progress-fill" id="main-progress"></div>
                </div>
                <span class="progress-text" id="progress-text">0% Conclu√≠do</span>
            </div>
        </header>

        <div class="scale-info">
            <h3>Escala de Pontua√ß√£o:</h3>
            <ul>
                <li><strong>1 - Nunca ou raramente:</strong> De cada 10 situa√ß√µes reage dessa forma sem necessidade de ajuda no m√°ximo 2 vezes</li>
                <li><strong>2 - Com pouca frequ√™ncia:</strong> De cada 10 situa√ß√µes desse tipo reage dessa forma sem necessidade de ajuda 3 a 4 vezes</li>
                <li><strong>3 - Com regular frequ√™ncia:</strong> De cada 10 situa√ß√µes reage dessa forma sem necessidade de ajuda 4 a 6 vezes</li>
                <li><strong>4 - Muito frequentemente:</strong> De cada 10 situa√ß√µes reage dessa forma sem necessidade de ajuda 6 a 8 vezes</li>
                <li><strong>5 - Sempre ou quase sempre:</strong> De cada 10 situa√ß√µes reage dessa forma sem necessidade de ajuda 8 a 10 vezes</li>
            </ul>
        </div>

        <form id="questionnaire-form">
            <!-- Informa√ß√µes da Avalia√ß√£o -->
            <div class="patient-info">
                <h3>Informa√ß√µes da Avalia√ß√£o</h3>
                
                <div class="info-section">
                    <h4>Dados da Crian√ßa</h4>
                    <div class="form-group">
                        <label for="patient-name">Nome da Crian√ßa:</label>
                        <input type="text" id="patient-name" name="patient-name" required>
                    </div>
                </div>

                <div class="info-section">
                    <h4>Seus Dados (Respons√°vel)</h4>
                    <div class="form-group">
                        <label for="evaluator-name">Seu Nome Completo:</label>
                        <input type="text" id="evaluator-name" name="evaluator-name" required>
                    </div>
                    <div class="form-group">
                        <label for="evaluator-email">Seu Email:</label>
                        <input type="email" id="evaluator-email" name="evaluator-email" required>
                    </div>
                    <div class="form-group">
                        <label for="evaluator-phone">Seu Telefone Celular:</label>
                        <input type="tel" id="evaluator-phone" name="evaluator-phone" pattern="[0-9\s\(\)\-\+]+" placeholder="(11) 99999-9999" required>
                    </div>
                </div>

                <div class="info-section">
                    <h4>Data da Avalia√ß√£o</h4>
                    <div class="form-group">
                        <label for="evaluation-date">Data de Hoje:</label>
                        <input type="date" id="evaluation-date" name="evaluation-date" required>
                    </div>
                </div>
            </div>

            <!-- Sistema de Abas Principais -->
            <div class="tabs-container">
                <div class="main-tabs">
                    <button type="button" class="tab-button active" data-tab="comunicativas">
                        üó£Ô∏è Habilidades Comunicativas
                        <span class="tab-progress" id="progress-comunicativas">0/40</span>
                    </button>
                    <button type="button" class="tab-button" data-tab="sociais">
                        üë• Habilidades Sociais
                        <span class="tab-progress" id="progress-sociais">0/40</span>
                    </button>
                    <button type="button" class="tab-button" data-tab="funcionais">
                        üè† Habilidades Funcionais
                        <span class="tab-progress" id="progress-funcionais">0/29</span>
                    </button>
                    <button type="button" class="tab-button" data-tab="emocionais">
                        üí≠ Habilidades Emocionais
                        <span class="tab-progress" id="progress-emocionais">0/40</span>
                    </button>
                </div>

                <!-- ABA: HABILIDADES COMUNICATIVAS -->
                <div class="tab-content active" id="tab-comunicativas">
                    <div class="sub-tabs">
                        <button type="button" class="sub-tab-button active" data-subtab="contato-visual">
                            Contato Visual <span class="sub-progress" id="sub-progress-contato-visual">0/10</span>
                        </button>
                        <button type="button" class="sub-tab-button" data-subtab="comunicacao-alternativa">
                            Comunica√ß√£o Alternativa <span class="sub-progress" id="sub-progress-comunicacao-alternativa">0/10</span>
                        </button>
                        <button type="button" class="sub-tab-button" data-subtab="linguagem-expressiva">
                            Linguagem Expressiva <span class="sub-progress" id="sub-progress-linguagem-expressiva">0/10</span>
                        </button>
                        <button type="button" class="sub-tab-button" data-subtab="linguagem-receptiva">
                            Linguagem Receptiva <span class="sub-progress" id="sub-progress-linguagem-receptiva">0/10</span>
                        </button>
                    </div>

                    <div class="sub-tab-content active" id="subtab-contato-visual">
                        <h3>üëÅÔ∏è Contato Visual</h3>
                        <div class="questions-grid" id="contato-visual-questions"></div>
                    </div>

                    <div class="sub-tab-content" id="subtab-comunicacao-alternativa">
                        <h3>ü§è Comunica√ß√£o Alternativa</h3>
                        <div class="questions-grid" id="comunicacao-alternativa-questions"></div>
                    </div>

                    <div class="sub-tab-content" id="subtab-linguagem-expressiva">
                        <h3>üó®Ô∏è Linguagem Expressiva</h3>
                        <div class="questions-grid" id="linguagem-expressiva-questions"></div>
                    </div>

                    <div class="sub-tab-content" id="subtab-linguagem-receptiva">
                        <h3>üëÇ Linguagem Receptiva</h3>
                        <div class="questions-grid" id="linguagem-receptiva-questions"></div>
                    </div>
                </div>

                <!-- ABA: HABILIDADES SOCIAIS -->
                <div class="tab-content" id="tab-sociais">
                    <div class="sub-tabs">
                        <button type="button" class="sub-tab-button active" data-subtab="expressao-facial">
                            Express√£o Facial <span class="sub-progress" id="sub-progress-expressao-facial">0/10</span>
                        </button>
                        <button type="button" class="sub-tab-button" data-subtab="imitacao">
                            Imita√ß√£o <span class="sub-progress" id="sub-progress-imitacao">0/10</span>
                        </button>
                        <button type="button" class="sub-tab-button" data-subtab="atencao-compartilhada">
                            Aten√ß√£o Compartilhada <span class="sub-progress" id="sub-progress-atencao-compartilhada">0/10</span>
                        </button>
                        <button type="button" class="sub-tab-button" data-subtab="brincar">
                            Brincar <span class="sub-progress" id="sub-progress-brincar">0/10</span>
                        </button>
                    </div>

                    <div class="sub-tab-content active" id="subtab-expressao-facial">
                        <h3>üòä Express√£o Facial</h3>
                        <div class="questions-grid" id="expressao-facial-questions"></div>
                    </div>

                    <div class="sub-tab-content" id="subtab-imitacao">
                        <h3>üëØ Imita√ß√£o</h3>
                        <div class="questions-grid" id="imitacao-questions"></div>
                    </div>

                    <div class="sub-tab-content" id="subtab-atencao-compartilhada">
                        <h3>üéØ Aten√ß√£o Compartilhada</h3>
                        <div class="questions-grid" id="atencao-compartilhada-questions"></div>
                    </div>

                    <div class="sub-tab-content" id="subtab-brincar">
                        <h3>üéÆ Brincar</h3>
                        <div class="questions-grid" id="brincar-questions"></div>
                    </div>
                </div>

                <!-- ABA: HABILIDADES FUNCIONAIS -->
                <div class="tab-content" id="tab-funcionais">
                    <div class="sub-tabs">
                        <button type="button" class="sub-tab-button active" data-subtab="auto-cuidado">
                            Auto Cuidado <span class="sub-progress" id="sub-progress-auto-cuidado">0/9</span>
                        </button>
                        <button type="button" class="sub-tab-button" data-subtab="vestir-se">
                            Vestir-se <span class="sub-progress" id="sub-progress-vestir-se">0/10</span>
                        </button>
                        <button type="button" class="sub-tab-button" data-subtab="uso-banheiro">
                            Uso do Banheiro <span class="sub-progress" id="sub-progress-uso-banheiro">0/10</span>
                        </button>
                    </div>

                    <div class="sub-tab-content active" id="subtab-auto-cuidado">
                        <h3>üßº Auto Cuidado</h3>
                        <div class="questions-grid" id="auto-cuidado-questions"></div>
                    </div>

                    <div class="sub-tab-content" id="subtab-vestir-se">
                        <h3>üëï Vestir-se</h3>
                        <div class="questions-grid" id="vestir-se-questions"></div>
                    </div>

                    <div class="sub-tab-content" id="subtab-uso-banheiro">
                        <h3>üöΩ Uso do Banheiro</h3>
                        <div class="questions-grid" id="uso-banheiro-questions"></div>
                    </div>
                </div>

                <!-- ABA: HABILIDADES EMOCIONAIS -->
                <div class="tab-content" id="tab-emocionais">
                    <div class="sub-tabs">
                        <button type="button" class="sub-tab-button active" data-subtab="controle-inibitorio">
                            Controle Inibit√≥rio <span class="sub-progress" id="sub-progress-controle-inibitorio">0/10</span>
                        </button>
                        <button type="button" class="sub-tab-button" data-subtab="flexibilidade">
                            Flexibilidade <span class="sub-progress" id="sub-progress-flexibilidade">0/10</span>
                        </button>
                        <button type="button" class="sub-tab-button" data-subtab="resposta-emocional">
                            Resposta Emocional <span class="sub-progress" id="sub-progress-resposta-emocional">0/10</span>
                        </button>
                        <button type="button" class="sub-tab-button" data-subtab="empatia">
                            Empatia <span class="sub-progress" id="sub-progress-empatia">0/10</span>
                        </button>
                    </div>

                    <div class="sub-tab-content active" id="subtab-controle-inibitorio">
                        <h3>üõë Controle Inibit√≥rio</h3>
                        <div class="questions-grid" id="controle-inibitorio-questions"></div>
                    </div>

                    <div class="sub-tab-content" id="subtab-flexibilidade">
                        <h3>üîÑ Flexibilidade</h3>
                        <div class="questions-grid" id="flexibilidade-questions"></div>
                    </div>

                    <div class="sub-tab-content" id="subtab-resposta-emocional">
                        <h3>üòå Resposta Emocional</h3>
                        <div class="questions-grid" id="resposta-emocional-questions"></div>
                    </div>

                    <div class="sub-tab-content" id="subtab-empatia">
                        <h3>‚ù§Ô∏è Empatia</h3>
                        <div class="questions-grid" id="empatia-questions"></div>
                    </div>
                </div>
            </div>

            <!-- Navega√ß√£o entre abas -->
            <div class="tab-navigation">
                <button type="button" id="prev-tab" class="nav-button">‚¨ÖÔ∏è Anterior</button>
                <div class="tab-info">
                    <span id="current-tab-info">Habilidades Comunicativas - Contato Visual</span>
                </div>
                <button type="button" id="next-tab" class="nav-button">Pr√≥ximo ‚û°Ô∏è</button>
            </div>

            <!-- A√ß√µes do formul√°rio -->
            <div class="form-actions">
                <button type="button" id="save-draft" class="btn-secondary">üíæ Salvar Rascunho</button>
                <button type="submit" class="btn-primary" id="submit-evaluation">‚úÖ Finalizar Avalia√ß√£o</button>
                <button type="button" id="clear-form" class="btn-secondary">üóëÔ∏è Limpar Formul√°rio</button>
            </div>
        </form>

        <!-- Mensagem de Sucesso -->
        <div id="success-message" class="success-section" style="display: none;">
            <h3>‚úÖ Avalia√ß√£o Enviada com Sucesso!</h3>
            <p>Obrigado por completar a avalia√ß√£o. Os dados foram salvos com seguran√ßa.</p>
            <div class="success-actions">
                <button type="button" onclick="location.reload()" class="btn-primary">üìù Nova Avalia√ß√£o</button>
                <a href="terapeuta.html" class="btn-secondary">üë®‚Äç‚öïÔ∏è √Årea do Terapeuta</a>
            </div>
        </div>
    </div>

    <!-- Script melhorado com verifica√ß√£o de conex√£o e backup triplo -->
    <script src="script-pais-melhorado.js"></script>
    
    <!-- Adicionar aviso de salvamento autom√°tico -->
    <style>
        .auto-save-info {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 15px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-size: 12px;
            color: #666;
            z-index: 1000;
        }
        
        .connection-status {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
            z-index: 9999;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .backup-notice {
            background: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
        }
    </style>
    
    <div class="auto-save-info">
        üíæ Salvamento autom√°tico a cada 30 segundos
    </div>
</body>
</html>